function [y1] = A3_16_1(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 08-Feb-2022 19:24:00.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx85 matrix, input #1
% and returns:
%   y = Qx16 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Layer 1
IW1_1 = [86.286662068965526373 83.647213577586185806 67.606492133620662344 69.315237392241357384 76.447305474137934311 60.35449258620688795 63.776550991379302502 106.24191039655173086 100.22840039008623592 137.82262987500001827 70.622931099137943534 115.55821238577584609 69.798588577586201609 58.206466163793102453 61.630290732758624017 74.370368749999997249 84.284704525862082392 90.128224999999986267 63.982562500000007333 85.120092241379296638 97.523865732758594049 113.60751982758618794 65.094608836206873548 68.129705202586222867 90.678232644396530304 62.536637038793102761 68.186314715517255536 52.439924935344834012 53.401671681034486028 56.641482586206890915 55.277188987068967663 50.277183685344823516 51.139709094827601632 75.031368318965533604 60.776962995689657987 58.265685086206900678 99.003801939655176056 82.725988362068960669 64.113630387931010546 54.761350495689654849 55.091639008620688855 75.815893749999986539 70.982284202586214406 99.011427801724167352 105.71624008620688073 98.83612698275861419 111.10696637931036435 101.10096195474137915 110.79494709051725465 118.4145064655172348 119.63668469827585739 120.91975646551725276 115.92764202586204192 117.17660711206899293 84.018545043103472381 78.078138297413786972 83.430587456896546428 85.32183745689656007 88.972757974137948622 87.610413362068968013 93.338124353448293391 99.063783836206923183 78.803447650862082696 78.880478053879315326 97.743367025862056607 115.99787844827584138 118.2269349137931016 113.37462025862069481 116.71426101293103272 116.29055926724136327 99.892174008620685299 100.4855974137931014 90.532713362068960805 109.86476099137931328 99.703397198275851565 90.224829073275870428 97.782423706896537396 100.728503448275859 82.16549478017239494 80.368701342672423493 85.071364870689649251 93.64725029525864386 83.750409137931043801 81.067414224137920087 82.173173922413809578;113.43363636363633873 134.25654358974355773 123.41068041958040169 126.05933263403264277 177.54261328671333331 76.770640116550140419 108.09367342657340316 216.64217715617718341 224.61761981351978079 232.8122610722610375 181.54770769230768224 226.54397435897433866 82.717861305361310542 72.586945594405605675 74.416454778554793847 98.813981585081577919 86.080598601398563119 111.65569184149183002 97.225555244755284434 183.49551771561772284 67.530041958041977068 94.501461305361303289 93.925938927738954476 163.02348764568762363 212.04673986013986564 154.97814662004654451 180.40145944055944938 110.6158909090908935 79.106889277389285553 106.79882470862470711 80.530864801864780134 73.166295804195783603 57.547169720279747196 88.339510023310026554 134.27722144522147119 75.44430909090908699 85.154622843822849632 61.636956876456899579 47.101471794871798693 53.547383916083923339 42.587178601398598232 51.205412820512826499 41.014891864801867882 128.25950559440553889 126.37747808857808707 122.38115780885782158 109.60172331002330282 145.61411585081586395 129.46480769230768715 126.61750745920744521 100.01287622377620323 137.08936596736597835 130.58177832167834254 137.18789277389274162 152.2625557109557235 155.27622750582750655 143.62754708624706268 155.81260163170162514 156.02582004662005488 108.48858135198133823 118.26369766899766489 96.999434265734265637 120.97262051282049811 99.834160606060606824 98.374992307692266991 112.05795361305364111 122.60748717948719388 88.91614032634035425 132.70688205128206505 106.77364801864803212 108.92571351981351313 70.869114685314684721 102.62877249417248038 82.619631934731941669 172.97019580419586759 74.600597202797189311 78.904293706293742616 70.455383216783218359 79.639927505827500909 70.334757109557116905 95.900713519813507446 62.724677855477828814 173.91764102564104633 73.036885780885754116 72.704835664335689671;82.156597101449264642 133.30684521739135562 106.83569817391304468 105.20328333333333148 123.64113469565215553 92.290077623188395251 103.65021994202901112 187.30728913043486727 175.33571284057975959 217.67627719130439345 147.17503301449275455 207.3079994782608253 103.94855014492752332 84.716989855072469595 93.809050144927553561 109.85614869565216623 126.0803075362318566 133.98525420289857379 115.09653507246376591 149.92489681159418069 138.79928057971017097 133.45550115942026537 73.21057710144926034 95.666650173913055255 145.17272691884062397 72.3127936985507489 108.68147947826084021 60.359539536231878287 58.412630318840584209 58.972274353623198806 57.828266782608679364 58.791860956521738046 58.114014956521735655 80.24276869565217396 77.389944057971007396 61.754260869565214875 102.09684492753622465 81.049988724637685777 59.475474115942027709 60.319864492753616503 53.307646347826093347 68.575102637681141005 56.440049420289838622 71.592853623188432266 101.71600028985504593 116.14352115942025989 116.02111884057967472 85.097539304347833422 89.458838492753642413 96.951930724637662706 112.61247594202899336 101.85311768115940367 89.934509275362316316 84.398347826086961732 41.500816811594205546 43.455706202898554125 46.700906492753617272 38.471296173913060557 37.224601971014500634 46.453087826086949974 56.192562318840579394 64.330985217391287279 32.84697353623188576 32.36231735652173569 53.842204637681163604 77.337764927536284176 87.671009275362337121 80.693615072463742877 74.366355652173893986 67.447598707536229767 58.796927217391314002 65.461649304347830025 56.224617304347823676 62.922988040869569204 51.453351188405783034 41.76734234782609434 54.740701159420289912 51.610307420289849745 30.997086933333324765 29.920212791304354738 37.759136637681152138 45.574356043478246647 40.692736753623179879 31.903820579710146177 33.157006144927542834;102.08082132796781138 183.81955533199203501 205.47420724346076781 197.98192293762579652 220.71475653923545224 186.96889959758547661 214.44942816901408378 221.92464587525154229 226.6694406438632825 219.88192313883303086 221.12057665995973821 221.03136237424550359 142.64771951710261533 160.23659295774646694 180.35569396378269857 107.24025975855130355 121.41503641851106465 165.39541348088536665 190.43743883299796948 205.18513863179074974 127.13514607645876708 139.69996519114687317 84.943412877263597238 144.4001661971831254 188.65374104627767338 130.8392534205231641 169.09118028169015702 94.711049014084522923 71.9164173038229535 89.533400845070417517 75.002809678068430799 64.375272816901400574 59.175563702213288764 80.119972635814889372 125.07672676056340322 64.439576820925537959 79.605315694165000195 54.235599657947688002 44.838007062374252598 50.18541788732393627 45.381715778672024442 46.550008269617698886 37.537338148893354628 80.44403340040241801 88.851217303822934923 84.895884909456754031 96.045502816901432652 81.166801207243452154 92.088126156941655154 103.33411046277666401 106.32535855130785762 108.79993098591546641 100.54751006036218541 98.254030784708248802 61.248980281690144523 62.386075251509062412 68.146298189134810741 54.943826156941653949 59.013498993963779071 68.294744869215321614 78.156945674044294492 81.256028370221329737 56.483598591549302625 57.409766519114697303 62.900984305835009991 80.254605231388325137 84.723398993963769499 66.732865593561385253 90.379274647887342553 80.532423541247496246 57.655190543259550395 53.281921388329976708 43.349497545271617582 67.118675995975848991 66.736598591549295634 58.128226358148907593 70.110252515090564884 65.026123138833000326 51.357161750503024678 46.467332776659972637 55.868373963782701708 59.192023440643872334 67.786170201207255559 51.885501891348084769 45.427332273641852112;100.3849644617379937 126.71987846952006862 118.13997003891047655 113.34466783398184475 138.28742334630351252 102.52237198443582145 116.0220006485084383 173.07558158236057011 170.9971544747081964 188.65498962386507742 146.25512503242538287 184.92171167315174785 94.476209987029847071 84.40960337224382215 88.226971854734117073 94.503055642023340965 109.6768267185473178 119.8928696498054336 98.47595084306094293 128.37279403372241404 123.09308560311282577 129.42808184176394093 82.650155642023349856 121.07914656290529365 166.3629955901426456 112.62350415045392538 136.4651374837872595 73.658734241245127805 67.207272503242549533 79.448949675745794252 70.278651232166012619 59.302016446173809072 60.07905354085603733 82.558422568093391192 83.962301426718553898 57.010151361867691833 107.17533722438392374 83.800529571984412769 60.891045654993504854 54.151887457846967777 55.875626186770425363 71.400786511024662673 62.471210596627756217 97.264315434500645097 115.15960830090789102 116.98942321660182131 124.30464902723733189 103.13036446173801153 115.23518962386511078 121.29944319066152048 130.56173540856028126 121.36166083009079841 117.71101530479896269 116.18911634241246134 71.751404280155654192 67.621953437094660444 73.799255512321650485 71.171736316472092199 73.957701556420261113 80.623258754863798003 86.218156160830062618 95.378824513618667424 68.272971335927394421 71.860361867704270367 96.501065110246429413 111.81863203631647252 113.4360667963683369 109.94420259403374018 112.76349182879380351 111.67544721141373998 94.725544617380009527 97.917171854734107228 83.138634396887155731 105.04223398184174698 94.178457976653675132 90.530182490272395057 98.054056031128396853 102.68405058365756588 80.294621660181562106 80.808962645914405698 89.709455382619978536 97.894649546044078647 81.68228728923475046 89.558042801556396739 90.677780674448769105;88.929329614604455401 107.64155233265718437 69.970793042596355349 66.863429636916833942 103.70251606490870699 42.598830486815408847 62.19500472616632436 197.27703042596348837 186.60101663286002349 231.28875192697773855 134.31650933062880426 232.71319492900613568 39.774312961460438487 35.709852336713993282 45.202538458417841127 35.136280085192694855 41.985363225152120492 118.09886693711966643 80.052010344827593258 199.51812048681537703 58.332793427991873614 126.22799939148075055 96.620846044624741467 173.57605091277889642 226.88371987829611953 158.72688864097364103 204.60344421906688694 111.81549168357000212 69.039615375253561069 94.505704908722080404 66.683329776876263395 65.330799939148079147 51.142587829614598149 98.946024949290091399 158.1948653144016248 76.966009533468550785 101.29493853955375471 63.454451156186614469 47.433063610547677058 54.239309614604479748 44.917690425963485268 52.744262352941177596 38.584923306288025913 71.731401014198794996 58.939301277890464803 45.649027545638944048 58.70751478701826187 59.621033995943200523 70.304356551724140445 96.943170993914804967 76.844781744421894132 110.82205517241376924 90.410495131845834749 107.44215618661257849 56.866915111561873175 53.469783144016219012 60.676199716024349584 52.21701969574036184 60.449935983772824954 72.733747667342782961 70.520160243407715939 85.807821095334674055 62.431707160243412602 71.106921906693685287 82.031182150101415118 102.36277038539552109 111.19797748478701749 86.887238336713991771 109.01821196754563914 103.79123184584180706 78.061050304259637755 68.843196511156193651 56.890577707910729544 89.832037728194706006 95.983953955375227451 73.448306693711970183 83.413816632860033451 76.998866937119672116 69.343753955375248665 64.68169344827585121 74.711113387423935706 71.799921906693711549 97.665318458417843317 69.650289858012158106 60.933971805273841937;117.15000045558088004 167.18845785876990817 165.11397403189064903 148.96248838268789427 170.04416173120725375 156.80351981776763637 182.77139453302964966 188.8901808656036394 177.1234373576309622 183.47552346241454302 193.9563366742597168 200.52643394077443872 135.56339977220952164 143.35781298405470352 173.27553781321188353 99.122525056947608846 123.95990068337131618 178.0778633257403385 191.34220911161736467 198.46108154897493137 151.24441457858770832 170.34853097949883249 124.91312118451023139 184.05675148063784263 185.25700113895217669 179.991860820045531 195.41804396355348672 178.19393872437353821 109.82734897494303539 149.06519220956718641 108.78258974943055648 112.07645717539865871 72.775459749430524425 145.93498838268791928 190.07109794988605245 148.91980865603642314 141.03793735763096606 107.96622437357630986 63.115433029612731275 87.260255580865575098 53.227880432801818245 72.246512300683363605 41.524593712984042781 88.387730523918023096 93.880135307517065257 83.739198861047839273 101.73191753986333197 85.075276765375861032 103.15870227790431102 124.72240956719817007 118.26096674259680697 134.99246423690206598 120.74544305239179209 124.08026674259679112 58.660057403189078684 56.752120045558079653 66.806531890660593831 52.068105694760824065 58.173490432801813199 75.326880865603641269 83.246632118451060478 93.179274715261968254 59.544875854214126321 64.568712528473795942 92.043531890660602812 120.95289225512529185 126.02414054669704058 108.49871366742597445 126.24667790432803827 124.39784350797266654 85.424667425968095813 88.327443735763097266 61.409313029612754065 105.91848359908883026 87.170508883826869351 84.124608428246034464 96.175475854214099058 98.691938496583148321 68.859398633257384859 72.685255375854211479 79.210343280182243575 90.210565148063778906 82.699968337129845963 83.186217312072898267 63.610938041002270893;135.82382653061225142 186.10882653061224801 215.07720408163265802 215.89681207482988157 216.07648299319728835 211.18992397959186746 217.2190612244897352 207.65214285714279185 210.78768027210881542 205.4074931972789102 212.7379722789116272 202.58749914965983407 155.48186768707486749 186.04595425170072076 196.94509863945577877 116.23221513605440691 122.15500867346938207 166.40934030612243077 201.40804455782310356 198.31812363945576294 127.19182568027207481 138.55989166666662982 164.48740816326528602 193.4270051020408232 193.19646938775511558 189.32636394557829362 198.71313911564627119 192.82435085034009603 183.74503894557818739 191.83239965986396669 182.21938979591834595 189.47203350340132033 173.27107278911563526 153.25901955782310893 188.60143537414967341 182.72334965986397037 126.41101411564626744 116.23532176870749311 128.7849858843537163 171.63041156462583103 150.17747721088431945 105.4789464285714331 89.432315136054398863 99.320762585034003678 108.82285391156463561 102.77681972789112308 107.32989778911564827 113.49307976190472402 111.71952312925165529 109.71753129251699477 109.50022602040813524 113.67224710884353556 109.25416955782310424 106.46790697278908056 101.46506547619046046 108.1586993197278872 99.757734523809531879 98.962537074829910466 100.07213299319727184 77.805598129251720252 85.542971938775480112 77.318293707482979471 80.060131632653053657 69.249827380952368117 96.657780612244891927 112.48326904761904643 119.17955697278908644 119.17489608843534654 103.08359897959181239 108.47025051020409592 122.85223962585034485 108.21225952380949309 116.38580833333327291 104.87395510204078164 158.74355289115649725 63.261751190476196882 69.517876020408152726 67.239591666666655101 59.907245578231282934 56.780871768707470437 86.78275646258502718 62.902216836734680783 150.56862653061224933 67.188830782312905399 65.606694387755069897;97.222037205081662137 90.160386025408342903 85.889871125226861182 86.765985626134295217 98.978011070780397063 76.393278765880225478 80.612130852994567931 109.37729836660614069 108.06309689655168427 133.60951088929218145 85.927077767695095645 108.02591651542648776 75.456279001814891672 69.73486023593463301 70.591769019963678033 75.087717023593469889 85.59401328493646588 88.836340108892926537 70.461663030852974998 79.5720105263157933 96.998442468239545633 107.53890635208712467 115.63753067150635445 124.17552849364788869 134.23883411978221147 130.90237205081669458 108.90416950998182699 121.80586007259526582 131.9623402903810927 141.43944192377495028 136.62202613430125098 128.84736388384757788 122.30637422867512498 104.6019372050816969 90.920296733212353502 103.74232776769508746 112.86562431941925411 110.60224646098004087 102.30074355716877221 106.49358947368422434 102.95377205081669558 104.42280943738654742 96.060671143375685688 89.228636297640662178 100.23753629764063078 97.136027027223235564 106.38349435571686286 93.073109110707818559 103.38624519056259032 113.47103266787658526 116.12484736842104383 118.54371324863882364 108.21341252268599931 110.73182794918332661 70.565941542649724738 69.44741139745914893 73.707508021778579632 68.440275390199644789 70.54334393829400085 72.294666787658783846 81.292313502722308272 85.920169691470078988 60.580389237749542986 61.015846406533576385 95.320644827586207271 119.30593411978219365 122.73466370235935585 125.18130108892920305 113.19471343012706654 116.17142686025407272 108.5899754990925743 116.73241052631578896 104.34943593466425682 113.27896333938291207 101.51013557168782597 77.764252268602547247 87.89918493647913067 93.535889292196017664 64.359373811252268638 65.128924682395648915 75.835295281306699167 88.297786569872968698 79.640627586206889532 66.994466243194167987 68.569189110707796431;114.16416312056733773 129.85772092198581618 142.2396807328605064 137.40934491725766975 156.10907765957443871 132.33861524822694378 142.05012009456260103 166.16708132387699948 165.43698664302596057 176.26334728132383134 149.78515567375893625 171.86806903073281205 101.32053758865248483 104.80085141843970575 107.13797990543736205 93.328649054373528315 99.869345744680899202 108.82402683215130423 101.88398061465719024 121.07050827423169892 102.57523652482271359 108.89971879432623325 139.6886858156027813 170.93712494089831466 177.14614326241144227 173.39263085106381368 171.42259066193852846 161.84131465721043242 174.0147771867612505 180.94660375886513748 176.66478735224583829 173.39192257683220078 166.55457517730499717 109.30210401891253014 115.45815106382977433 112.03482281323873337 107.31278782505908964 102.36561796690305925 105.16634917257684378 119.69211122931443469 116.99022884160758906 97.470654964538994136 87.502521040189108703 90.708151773049664257 104.34039137115843232 102.52446442080378119 111.62969231678489734 94.396799763593406851 107.70067352245861514 118.71494397163122869 121.94950981087471575 123.48330614657209026 113.53665768321511109 115.71039669030730579 66.979963947990526663 65.669860992907786112 70.3382367612293109 63.975643380614648947 67.61908898345150476 72.367243498817956038 78.484921985815603307 84.766541252955036612 61.887298853427900269 63.799832033096926409 98.598211938534262799 122.45970330969271345 125.71211182033098908 125.83583794326244742 117.85436962174934195 120.62474669030730468 109.76342813238771612 116.67457033096930274 100.28236371158389773 116.06077139479909022 107.5960141843971769 79.977271276595715221 87.808801654846348583 92.276916548463361778 69.657684503546065002 69.907113167848720536 82.942373286052003323 89.75713971631206789 83.817840425531898063 79.790696690307356675 79.533912765957452962;99.654477829638295816 143.2281203033838608 131.22580945157525889 127.91139381563588984 154.57883313885650978 112.18563255542593993 127.39387631271875989 212.0873663943990266 204.08906919486577181 232.88772462077014325 173.72780315052506239 235.00077479579928763 89.271868611435195362 96.234999463243866558 100.15071330221702794 78.301529568261358349 81.707706417736247317 137.26930898483075794 125.02271610268378765 203.80037456242709482 92.978992065344215234 123.24365379229870143 124.99252987164524598 176.5400673278880106 220.22593465577605798 161.37958938156364752 197.62786744457409327 131.51653780630104507 132.93055064177357849 140.02661271878639582 139.03891703617267694 123.88188821470242829 128.75097794632435466 102.4507607934655482 144.98494352392066276 100.0840282380396502 92.156579813302187176 74.293876779463232651 88.711454492415384721 101.64127164527421598 106.79566116686112309 72.91159323220537658 73.155797899649911642 70.71217747957993538 81.076243407234514393 77.151971598599786262 88.79311236872811719 76.362285297549604479 81.192631505250872692 94.264813302216992952 97.57564107351223015 103.27088448074681537 87.424490431738618668 88.71839241540250498 47.624227526254372833 58.938094317386223508 63.765583827304553211 32.778604247374559577 34.598113955659272278 59.394423220536765484 69.368149124854156184 76.263278413068832151 38.536398133022181867 52.585924294049014804 63.345195449241529673 81.8748932322053804 91.590790781796940223 77.876603850641785698 82.851654842473763551 76.22243943990665116 62.566903850641772067 66.002571995332530719 57.113771505250873872 68.350943873978962984 59.768559276546092462 57.572748308051345134 70.382413185530921851 66.131991715285877831 48.926125437572920873 45.132540128354726505 52.043187514585760312 61.961672812135354604 56.548700700116690143 46.22226240373396422 44.418463477246177717;114.39173903548683597 183.82598544131033691 198.67973885350326668 188.80665659690632197 205.0367352138307524 190.61070345768894185 208.66110400363970712 222.01158052775247143 216.62990900818923024 220.51979253867148145 221.57701455868973994 229.03853867151966028 146.73845304822563662 170.70147725204731159 182.75821246587807423 114.4308171064604096 117.90613175614195995 167.19178380345769597 195.30770727934483943 215.49110555050049243 123.36486951774342913 134.0082301182893616 147.21698362147404282 208.7030250227479371 218.46845768880800165 206.73085414012746241 218.05155304822568496 193.46030400363966351 167.88087716105559366 191.04002456778886199 167.19876251137392842 170.55233721565053884 145.12824604185624366 125.25797670609648549 187.54306178343952638 137.74084331210193 100.93058871701545343 77.421751410373062185 88.744830391264812874 116.60464877161054176 104.793986078252928 69.903568425841669409 64.24867744313014839 70.170184986351202383 83.366347315741577972 87.499189171974549595 91.950645404913530001 74.587993539581404434 78.961495814376675639 89.845681073703389075 94.034776160145582935 95.933445313921779984 85.042947952684244228 84.521164513193781431 50.090683621474049403 57.896015468607828325 62.615146951774320883 38.552598316651497612 40.868530573248413873 57.194419199272068965 68.096867060964527241 70.497881801637859667 42.314217379435852706 47.580666060054596755 60.863475523202914985 78.395190445859867623 86.541148043676088264 73.720674340309358286 79.473081255686992108 74.826207188353080824 60.555371428571447723 61.880128753412201092 53.245788989990906259 65.926755595996354486 61.688171610555059488 53.826517197452233177 64.652510464058252637 61.291834485896288243 47.209760782529571088 42.431484531392179349 51.233952957233860559 57.995942402183807474 59.412215104640559105 45.817898544131040239 42.694434303912657924;106.8286767151767549 100.1737461538461389 65.367951683991691425 60.181412120582123748 94.991044677754686631 39.676965072765078446 61.328207380457378406 176.95265613305613783 165.58824220374222591 198.38680686070694037 143.690583700623705 196.14898378378379107 40.982481247401260305 34.160381871101876072 45.648527609147613759 36.888549293139291763 45.544145550935546396 112.92403347193346974 91.07541559251558283 173.97641954261956698 63.514548856548863398 118.14940602910603218 178.74511018711018551 218.00498128898132677 221.08233264033262344 219.50546008316010216 212.43195280665281643 218.68178607068608699 207.53300207900207397 216.69783721413725175 201.93609521829523601 219.28353659043656876 195.10940623700628294 151.05397255717258531 174.81296029106030687 186.56807671517674407 121.12146112266114528 120.81411933471937914 139.92734220374219944 182.34006590436590045 151.79276049896049017 120.02443139293139041 107.76411164241166318 63.51081808731807854 58.605595904365912929 48.238896133056123006 62.264311517671536933 53.734802910602915915 68.479617463617486806 93.957038877338902694 82.893658627858627597 106.03182723492724904 87.363028690228702544 98.086686902286928103 41.928062806652803829 40.78332460498960188 46.374459875259873343 36.628486403326412812 43.230320124740124754 58.313070893970888164 57.514381704781705196 72.344499168399153177 47.812037006237019909 54.637167318087342949 87.447874636174645957 110.04893284823286592 113.42038212058214697 107.93974553014552953 107.78401164241164167 111.48350706860709636 95.027658212058199183 100.08208503118504495 84.957224948024958167 101.51297962577960732 94.533430561330547448 71.001039916839928878 78.524548024948032321 81.601635550935540664 59.519446133056142401 64.000486070686079643 74.760883575883582353 78.482322661122694285 85.771659459459471009 76.711092099792125509 60.461360083160101908;119.60203143776824675 154.6968304721029881 176.1067501072961079 178.67711301502151855 205.94698605150207982 140.87079584763952766 175.658926287553669 222.94540021459224022 223.1789452789699908 227.44138948497854358 214.43640407725320074 226.54972628755371034 81.765170171673844379 87.895750171673810769 104.12228111587980095 64.422556083690977857 68.619781223175962737 136.23872768240346431 145.63995182403436957 191.84282027896992417 85.767484227467789992 119.73698154506436708 172.20017489270381361 219.92894152360511839 223.81634055793983862 219.92973197424899467 218.20530053648067792 217.50406512875539988 212.02642811158796121 222.58922317596565676 205.8626971030042796 218.80815118025751076 203.39672671673818627 135.18968776824036127 170.386267918454962 165.57580590128756626 104.3763624463519335 100.1862945278969903 122.90047467811157844 162.08548165236047112 144.99573830472098734 95.589247103004282735 90.183382038626604071 73.064484120171670156 79.396963626609434073 73.539354130901315898 86.860621244635211724 73.226779613733910423 82.777619098712420964 97.310279721030028099 99.827015450643770578 104.34595268240344978 90.828409549356237562 94.065230150214588889 54.071156223175954381 57.894717628755330452 59.975771673819735952 46.950817424892719032 51.206410085836921553 61.012733369098718583 64.676386373390556628 71.776884120171686732 51.22710300429184116 55.923840557939911378 81.812161266094435064 96.780527575107299754 102.55099849785408139 95.076096244635195376 95.256337339055789926 94.780377360515018381 89.122922639485011587 89.3129769313304962 81.343725407725301579 89.515166309012911938 96.319326502145912627 67.167590879828310335 72.676876394849770691 76.037691094420580384 58.125660300429210281 61.451004935622314918 74.668255150214591254 74.445421888411985378 90.563857725321881276 74.00296469957079637 61.217419635193145666;124.52834600760456851 195.11829562737639776 213.07744866920151594 209.90704828897335688 214.00020532319388167 210.75729733840299218 217.51821577946770958 215.6488697718631613 211.88023669201515986 212.53544296577945261 218.10254372623572294 220.13984600760463195 160.58319990494294416 186.40392100760450944 204.35001007604560641 116.94243726235741576 132.91064562737642518 190.68899429657793121 216.61102851711027029 220.64977756653991037 154.35843982889733184 170.7276491444866906 191.35544201520909269 215.72374714828904985 211.6064676806083753 209.46353326996202782 219.26228326996195506 222.65105228136883397 206.89728612167294841 208.35437832699619776 199.40379258555131514 217.76670722433462402 203.90578688212923453 187.53489068441066934 219.3490332699620069 218.00681368821287265 162.32803697718628655 151.36212366920150885 156.8915028517110386 206.80538868821290066 183.43220009505702706 132.58947376425857101 107.33205071292775301 56.726773574144480961 61.726123669201506061 60.641377946768074025 69.028419486692015994 54.231225950570340899 62.103357224334601483 75.590921197718657254 79.319979182509484872 85.663527946768041943 69.037041064638799526 68.388595152091269824 42.23967528517110992 42.501978517110266864 44.627867585551328489 39.711018726235735699 41.85694187262357957 47.119928136882137437 54.582854087452467695 57.966742680608362548 38.72510809885930172 37.199534923954360011 59.408037072243345733 73.25480884030417883 80.756117775665387626 74.795706653992411361 69.102010456273760042 68.817521387832712776 63.942488688212918646 66.442613783269962369 56.865003165399244267 60.678639163498097275 71.228370152091272871 46.251918726235743407 56.022148764258545839 54.467575855513295835 36.165969182509506652 38.42194837452470324 54.400653326996184944 46.618944201520911008 73.241774277566520368 54.127288602661593586 44.730004591254761692;127.32752957042957576 171.25225974025974551 163.6797594405594225 148.72660218781217623 161.69304789210792705 167.35690069930072355 176.0096383616383946 183.01701948051950808 173.14345188811188336 181.97546558441561615 183.51747852147852313 192.62047752247752896 153.79677102897102259 165.10236293706293509 185.50566693306691946 122.06241948051948043 140.67113596403595466 183.50159040959039203 195.96493256743255529 202.0260199800199814 159.71219460539458623 175.48699020979020702 180.26343256743254528 192.9063612387612352 186.08395129870123696 189.62634968031969152 198.167533066933089 197.71884215784217531 183.9345098901098936 190.33872485514484652 174.94946073926072927 191.81480619380621988 180.46870389610393204 183.33842587412587477 204.42357402597403393 201.26556183816182966 168.44558321678323409 159.8409502497502217 162.37127952047953272 195.58585414585417084 179.56948101898100845 150.03776213786215976 126.72468081918083271 75.967031168831169907 85.812187812187815439 82.028464935064931751 98.457869630369614811 72.427769780219762197 88.746435364635374299 108.86743936063936644 109.98580139860139582 118.51259460539459667 103.10347382617383971 103.4160405594405745 45.475315744255738082 46.461724855144858282 56.04040039960040076 36.262250000000001648 42.268015604395600349 62.879179520479524967 71.270805994005982598 80.137789210789222238 46.150532277722277286 53.09513854145855305 85.927464335664353712 111.36671258741256452 115.75024795204797101 108.89885144855141164 110.35713046953047467 111.09353086913085917 87.284234165834163832 100.44397542457545569 73.550787512487502795 98.356329470529487935 78.495221678321669856 76.166214485514487365 86.555415684315690328 90.716440059940083529 60.182095574425559903 66.826135704295722917 70.512893606393618029 82.648865784215786334 68.0773252747252684 78.566558641358611226 55.948005394605395679];

% ===== SIMULATION ========

% Input 1
x1 = x1';
% no processing

% Layer 1
z1 = negdist_apply(IW1_1,x1);
a1 = compet_apply(z1);

% Output 1
y1 = a1;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Negative Distance Weight Function
function z = negdist_apply(w,p,~)
[S,R] = size(w);
Q = size(p,2);
if isa(w,'gpuArray')
    z = iNegDistApplyGPU(w,p,R,S,Q);
else
    z = iNegDistApplyCPU(w,p,S,Q);
end
end
function z = iNegDistApplyCPU(w,p,S,Q)
z = zeros(S,Q);
if (Q<S)
    pt = p';
    for q=1:Q
        z(:,q) = sum(bsxfun(@minus,w,pt(q,:)).^2,2);
    end
else
    wt = w';
    for i=1:S
        z(i,:) = sum(bsxfun(@minus,wt(:,i),p).^2,1);
    end
end
z = -sqrt(z);
end
function z = iNegDistApplyGPU(w,p,R,S,Q)
p = reshape(p,1,R,Q);
sd = arrayfun(@iNegDistApplyGPUHelper,w,p);
z = -sqrt(reshape(sum(sd,2),S,Q));
end
function sd = iNegDistApplyGPUHelper(w,p)
sd = (w-p) .^ 2;
end

% Competitive Transfer Function
function a = compet_apply(n,~)
if isempty(n)
    a = n;
else
    [S,Q] = size(n);
    nanInd = any(isnan(n),1);
    a = zeros(S,Q,'like',n);
    [~,maxRows] = max(n,[],1);
    onesInd = maxRows + S*(0:(Q-1));
    a(onesInd) = 1;
    a(:,nanInd) = NaN;
end
end
