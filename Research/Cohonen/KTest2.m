function [y1] = KTest2(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 28-Dec-2021 21:06:56.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx90 matrix, input #1
% and returns:
%   y = Qx16 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Layer 1
IW1_1 = [0.013888888888888888118 0.013888888888888888118 0.013888888888888888118 0.66666666666666674068 0.83333333333333348136 0.75000000000000022204 0.93055555555555580227 1.0000000000000004441 0.90277777777777801216 0.97222222222222254295 0.87500000000000033307 0.58333333333333348136 0.93055555555555591329 0.7916666666666668517 0.18055555555555558023 0.3194444444444445308 0.097222222222222209886 0.027777777777777776236 0.94444444444444464182 0.93055555555555580227 0.95833333333333359239 0.84722222222222243193 0.59722222222222232091 0.30555555555555558023 0.11111111111111110494 0.013888888888888888118 0.041666666666666664354 0.69444444444444464182 0.84722222222222243193 0.9166666666666668517 0.27777777777777779011 0.77777777777777801216 0.61111111111111127148 0.069444444444444447528 0.19444444444444447528 0.19444444444444450304 0.22222222222222223764 0.23611111111111110494 0.16666666666666668517 0.62500000000000011102 0.62500000000000011102 0.38888888888888900608 0.93055555555555580227 0.83333333333333348136 0.75000000000000022204 0.13888888888888889506 0.097222222222222223764 0.055555555555555552472 0.56944444444444464182 0.62500000000000022204 0.59722222222222232091 0.94444444444444475284 0.87500000000000033307 0.90277777777777812318 0.16666666666666668517 0.13888888888888889506 0.16666666666666665741 0.50000000000000011102 0.65277777777777790114 0.6666666666666668517 0.75000000000000011102 0.83333333333333348136 0.88888888888888906159 0.18055555555555555247 0.16666666666666665741 0.055555555555555552472 0.41666666666666674068 0.45833333333333348136 0.34722222222222232091 0.90277777777777801216 0.83333333333333359239 0.69444444444444464182 0.18055555555555555247 0.15277777777777779011 0.23611111111111116045 0.36111111111111116045 0.25 0.40277777777777790114 0.68055555555555580227 0.91666666666666696273 0.80555555555555580227 0.15277777777777779011 0.33333333333333337034 0.63888888888888906159 0.097222222222222209886 0.48611111111111116045 0.69444444444444464182 0.38888888888888900608 0.72222222222222243193 0.87500000000000022204;0 0 0 0.40816326530612245804 0.95918367346938804285 0.7346938775510205577 0.89795918367346971856 1.0000000000000004441 1.0000000000000004441 0.59183673469387787502 0.42857142857142860315 0.57142857142857139685 0.40816326530612251355 0.57142857142857139685 0.83673469387755128324 0.28571428571428569843 0.44897959183673469274 0.75510204081632659179 0.14285714285714284921 0.40816326530612245804 0.77551020408163306996 0.16326530612244896656 0.79591836734693910405 0.83673469387755139426 0.18367346938775508391 0.59183673469387754196 0.85714285714285742834 0.48979591836734709398 0.67346938775510223341 0.75510204081632703588 0.38775510204081631294 0.81632653061224513813 0.55102040816326536277 0.42857142857142860315 0.46938775510204072683 0.42857142857142854764 0.20408163265306120127 0.14285714285714284921 0.10204081632653060063 0.83673469387755150528 0.53061224489795932868 0.59183673469387765298 0.93877551020408200877 0.79591836734693910405 0.87755102040816368447 0.020408163265306117351 0.18367346938775508391 0.081632653061224483282 0.71428571428571452362 0.83673469387755139426 0.89795918367346982958 0.81632653061224536017 0.81632653061224536017 0.93877551020408211979 0.02040816326530612082 0.040816326530612241641 0.10204081632653060063 0.55102040816326547379 0.7346938775510205577 0.89795918367346971856 0.83673469387755139426 0.93877551020408200877 1.0000000000000004441 0.14285714285714284921 0.12244897959183673186 0.34693877551020407823 0.63265306122449005422 0.69387755102040860056 0.40816326530612245804 0.85714285714285753937 0.7142857142857144126 0.38775510204081631294 0.061224489795918365931 0.061224489795918365931 0.061224489795918365931 0.44897959183673474826 0.28571428571428569843 0.32653061224489793313 0.81632653061224524915 0.97959183673469418796 0.77551020408163295894 0.9591836734693882649 0.16326530612244896656 0.16326530612244896656 0.89795918367346982958 0.28571428571428569843 0.46938775510204072683 0.22448979591836731862 0.26530612244897955332 0.53061224489795932868;0.026315789473684209065 0.052631578947368418131 0 0.89473684210526271965 0.90789473684210464377 0.6052631578947365032 0.94736842105263097125 0.97368421052631526358 0.72368421052631548562 0.63157894736842079553 0.52631578947368407029 0.34210526315789474561 0.69736842105263130431 0.40789473684210519888 0.23684210526315788159 0.72368421052631548562 0.47368421052631570767 0.30263157894736841813 0.68421052631578915815 0.57894736842105243291 0.21052631578947367252 0.8552631578947365032 0.55263157894736836262 0.18421052631578949121 0.77631578947368384824 0.57894736842105243291 0.30263157894736836262 0.23684210526315788159 0.64473684210526294169 0.71052631578947345048 0.27631578947368418131 0.64473684210526305272 0.74999999999999966693 0.30263157894736841813 0.5526315789473682516 0.72368421052631548562 0.51315789473684203514 0.27631578947368418131 0.052631578947368418131 0.80263157894736802955 0.64473684210526283067 0.28947368421052632748 0.78947368421052588339 0.69736842105263141534 0.65789473684210508786 0.42105263157894728954 0.36842105263157892692 0.065789473684210522664 0.73684210526315752077 0.63157894736842079553 0.44736842105263141534 0.60526315789473672524 0.65789473684210508786 0.55263157894736836262 0.092105263157894731729 0.32894736842105259944 0.61842105263157876038 0.31578947368421050879 0.78947368421052588339 0.81578947368421017572 0.4605263157894735615 0.72368421052631548562 0.88157894736842057348 0.68421052631578926917 0.4605263157894735615 0.078947368421052627196 0.71052631578947345048 0.44736842105263152636 0.092105263157894731729 0.80263157894736814058 0.49999999999999988898 0.28947368421052627196 0.38157894736842101757 0.17105263157894734505 0.065789473684210522664 0.38157894736842101757 0.31578947368421050879 0.30263157894736841813 0.81578947368421017572 0.90789473684210486581 0.671052631578947123 0.18421052631578949121 0.27631578947368418131 0.48684210526315779832 0.14473684210526316374 0.32894736842105265495 0.49999999999999988898 0.36842105263157892692 0.72368421052631548562 0.9342105263157889361;0.26000000000000000888 0.5999999999999999778 0.41999999999999998446 0.35999999999999998668 0.36000000000000004219 0.16000000000000000333 0.73999999999999999112 0.85999999999999998668 0.5 0.23999999999999999112 0.4000000000000000222 0.33999999999999996891 0.37999999999999994893 0.65999999999999992006 0.54000000000000003553 0.61999999999999999556 0.7399999999999998801 0.69999999999999995559 0.57999999999999996003 0.69999999999999995559 0.30000000000000004441 0.71999999999999997335 0.78000000000000002665 0.33999999999999996891 0.47999999999999998224 0.39999999999999996669 0.27999999999999997113 0.45999999999999996447 0.69999999999999995559 0.7399999999999998801 0.34000000000000002442 0.49999999999999994449 0.65999999999999992006 0.23999999999999999112 0.34000000000000002442 0.34000000000000002442 0.80000000000000004441 0.68000000000000004885 0.45999999999999996447 0.37999999999999994893 0.17999999999999999334 0.30000000000000004441 0.4000000000000000222 0.44000000000000000222 0.51999999999999990674 0.6399999999999999023 0.61999999999999988454 0.55999999999999994227 0.43999999999999994671 0.28000000000000002665 0.040000000000000000833 0.67999999999999993783 0.45999999999999996447 0.22000000000000000111 0.05999999999999999778 0.21999999999999997335 0.45999999999999990896 0.26000000000000000888 0.35999999999999998668 0.44000000000000000222 0.65999999999999992006 0.71999999999999997335 0.77999999999999991562 0.47999999999999992673 0.16000000000000000333 0.040000000000000000833 0.80000000000000004441 0.5999999999999999778 0.37999999999999994893 0.94000000000000005773 0.73999999999999999112 0.36000000000000004219 0.14000000000000001332 0.16000000000000000333 0.11999999999999999556 0.67999999999999993783 0.41999999999999992895 0.38000000000000000444 0.78000000000000002665 0.85999999999999998668 0.69999999999999995559 0.34000000000000002442 0.5999999999999999778 0.69999999999999995559 0.22000000000000002887 0.69999999999999995559 0.88000000000000011546 0.10000000000000000555 0.41999999999999992895 0.67999999999999993783;0.013888888888888888118 0.083333333333333328707 0.013888888888888888118 0.2222222222222222654 0.87500000000000011102 0.88888888888888906159 0.70833333333333348136 0.97222222222222232091 0.98611111111111127148 0.88888888888888917261 0.86111111111111127148 0.84722222222222243193 0.52777777777777790114 0.61111111111111127148 0.23611111111111116045 0.20833333333333337034 0.16666666666666668517 0.11111111111111110494 0.81944444444444464182 0.97222222222222243193 0.84722222222222243193 0.52777777777777790114 0.43055555555555563574 0.30555555555555558023 0.23611111111111110494 0.041666666666666664354 0.11111111111111110494 0.125 0.30555555555555558023 0.68055555555555569125 0.20833333333333334259 0.59722222222222232091 0.75000000000000022204 0.47222222222222237642 0.70833333333333348136 0.76388888888888906159 0.25000000000000005551 0.041666666666666664354 0.027777777777777776236 0.70833333333333337034 0.77777777777777801216 0.63888888888888906159 0.94444444444444464182 0.93055555555555569125 0.9166666666666668517 0 0.097222222222222223764 0.26388888888888895057 0.47222222222222232091 0.90277777777777801216 0.6666666666666668517 0.86111111111111127148 0.98611111111111127148 0.94444444444444464182 0.069444444444444447528 0.15277777777777779011 0.25 0.37500000000000011102 0.45833333333333348136 0.77777777777777801216 0.54166666666666674068 0.76388888888888895057 0.90277777777777801216 0.51388888888888906159 0.36111111111111121597 0.2222222222222222654 0.66666666666666674068 0.75000000000000011102 0.33333333333333337034 0.83333333333333359239 0.59722222222222243193 0.2222222222222222654 0.041666666666666664354 0.055555555555555552472 0.30555555555555558023 0.4444444444444445308 0.54166666666666674068 0.77777777777777801216 0.36111111111111116045 0.77777777777777790114 0.84722222222222243193 0.47222222222222232091 0.30555555555555558023 0.62500000000000011102 0.31944444444444447528 0.47222222222222237642 0.80555555555555569125 0.20833333333333334259 0.41666666666666674068 0.62500000000000011102;0.078947368421052627196 0.052631578947368418131 0 0.3421052631578946901 0.36842105263157887141 0.23684210526315788159 0.92105263157894678994 0.94736842105263119329 0.81578947368421017572 0.73684210526315763179 0.26315789473684209065 0.078947368421052627196 0.86842105263157853834 0.42105263157894734505 0.55263157894736836262 0.86842105263157842732 0.78947368421052588339 0.63157894736842079553 0.26315789473684209065 0.13157894736842104533 0.89473684210526260863 0.21052631578947367252 0.65789473684210508786 0.99999999999999955591 0.21052631578947367252 0.68421052631578926917 0.92105263157894690096 0.26315789473684209065 0.71052631578947345048 0.97368421052631526358 0.39473684210526305272 0.89473684210526283067 0.71052631578947345048 0.052631578947368418131 0.42105263157894734505 0.52631578947368418131 0.47368421052631559665 0.21052631578947367252 0.15789473684210525439 0.34210526315789474561 0.28947368421052632748 0.31578947368421050879 0.94736842105263119329 0.55263157894736836262 0.5526315789473682516 0.078947368421052627196 0.10526315789473683626 0.39473684210526316374 0.21052631578947367252 0.39473684210526316374 0.73684210526315763179 0.63157894736842090655 0.6315789473684206845 0.81578947368421017572 0 0.052631578947368418131 0.28947368421052632748 0.052631578947368418131 0.36842105263157898243 0.65789473684210497684 0.60526315789473661422 0.94736842105263119329 0.97368421052631526358 0.76315789473684170208 0.23684210526315788159 0.026315789473684209065 0.97368421052631526358 0.8157894736842100647 0.13157894736842104533 0.73684210526315752077 0.60526315789473661422 0.36842105263157892692 0.26315789473684209065 0.21052631578947367252 0.13157894736842104533 0.63157894736842079553 0.84210526315789446805 0.84210526315789446805 0.44736842105263141534 0.49999999999999977796 0.7631578947368418131 0.86842105263157853834 0.31578947368421050879 0.63157894736842079553 0.47368421052631576318 0.36842105263157898243 0.63157894736842079553 0.18421052631578946346 0.49999999999999988898 0.63157894736842079553;0.25675675675675679877 0.48648648648648629145 0.4459459459459457209 0.027027027027027028527 0.58108108108108058598 0.33783783783783782884 0.28378378378378382729 0.95945945945945831923 0.72972972972972915962 0.67567567567567510256 0.29729729729729725829 0.094594594594594599846 0.95945945945945831923 0.59459459459459418351 0.13513513513513514264 0.89189189189189077567 0.64864864864864801852 0.13513513513513514264 0.13513513513513514264 0.59459459459459396147 0.82432432432432345415 0.4459459459459457209 0.85135135135135042717 0.68918918918918858907 0.49999999999999977796 0.70270270270270207558 0.60810810810810767002 0.18918918918918919969 0.18918918918918919969 0.28378378378378377178 0.32432432432432434233 0.47297297297297280494 0.68918918918918847805 0.33783783783783788435 0.75675675675675602161 0.85135135135135042717 0.87837837837837740018 0.82432432432432334313 0.49999999999999966693 0.36486486486486480185 0.17567567567567568543 0.081081081081081085582 0.47297297297297280494 0.39189189189189188589 0.22972972972972974248 0.39189189189189188589 0.81081081081080996764 0.90540540540540448422 0.027027027027027028527 0.054054054054054057055 0.36486486486486480185 0.13513513513513514264 0.64864864864864801852 0.85135135135135042717 0.581081081081080697 0.79729729729729648113 0.93243243243243145724 0.22972972972972974248 0.20270270270270271395 0.22972972972972974248 0.32432432432432428682 0.27027027027027028527 0.28378378378378377178 0.17567567567567568543 0.25675675675675679877 0.013513513513513514264 0.71621621621621545106 0.47297297297297280494 0.27027027027027028527 0.97297297297297180574 0.85135135135135053819 0.608108108108107559 0.1486486486486486569 0.013513513513513514264 0.054054054054054057055 0.64864864864864812954 0.29729729729729725829 0.22972972972972974248 0.83783783783783694066 0.98648648648648529225 0.9054054054054043732 0.25675675675675679877 0.47297297297297280494 0.59459459459459418351 0.22972972972972974248 0.59459459459459407249 0.83783783783783694066 0.22972972972972974248 0.39189189189189177487 0.85135135135135031614;0.89830508474576298283 0.94915254237288160244 0.76271186440677984919 0.22033898305084742564 0.23728813559322031734 0.084745762711864403016 0.40677966101694917889 0.61016949152542387935 0.23728813559322031734 0.32203389830508477587 0.15254237288135594208 0.37288135593220345099 0.50847457627118652912 0.25423728813559320905 0.4237288135593221261 0.81355932203389857982 0.64406779661016955174 0.54237288135593231253 0.13559322033898305038 0.16949152542372883379 0.38983050847457634269 0.25423728813559320905 0.52542372881355947634 0.64406779661016966276 0.42372881355932207059 0.81355932203389857982 0.83050847457627141601 0.44067796610169501781 0.35593220338983055928 0.22033898305084745339 0.52542372881355936531 0.45762711864406790951 0.4067796610169492344 0.49152542372881363741 0.54237288135593231253 0.55932203389830525975 0.86440677966101719942 0.83050847457627141601 0.62711864406779671555 0.38983050847457634269 0.20338983050847458944 0.28813559322033899246 0.23728813559322031734 0.13559322033898305038 0.37288135593220345099 0.81355932203389857982 0.96610169491525443863 0.88135593220339014664 0.13559322033898305038 0.23728813559322031734 0.30508474576271188416 0.10169491525423729472 0.18644067796610169774 0.23728813559322031734 0.69491525423728828237 0.71186440677966111856 0.76271186440677984919 0.33898305084745766758 0.33898305084745766758 0.20338983050847456169 0.50847457627118652912 0.33898305084745766758 0.16949152542372880603 0.7288135593220341768 0.54237288135593231253 0.28813559322033899246 0.84745762711864425221 0.67796610169491544617 0.33898305084745766758 0.66101694915254249896 0.4067796610169492344 0.32203389830508477587 0.27118644067796615627 0.28813559322033899246 0.37288135593220345099 0.72881355932203406578 0.66101694915254249896 0.50847457627118652912 0.71186440677966111856 0.71186440677966111856 0.55932203389830514872 0.13559322033898305038 0.50847457627118652912 0.57627118644067809594 0.23728813559322031734 0.64406779661016966276 0.79661016949152574362 0.33898305084745766758 0.64406779661016955174 0.67796610169491544617;0 0.029850746268656715848 0.014925373134328357924 0.41791044776119395943 0.86567164179104438837 0.74626865671641762212 0.91044776119402948122 0.99999999999999955591 0.89552238805970119095 0.95522388059701446306 0.85074626865671598708 0.70149253731343252927 0.53731343283582078119 0.40298507462686561365 0.40298507462686561365 0.35820895522388052079 0.16417910447761191461 0.1343283582089551953 0.76119402985074602341 0.64179104477611925716 0.53731343283582067016 0.686567164179104239 0.3582089552238805763 0.14925373134328356883 0.65671641791044754743 0.31343283582089553896 0.20895522388059700747 0.16417910447761194237 0.52238805970149249092 0.70149253731343264029 0.25373134328358204481 0.686567164179104239 0.77611940298507442471 0.37313432835820886657 0.82089552238805940654 0.76119402985074602341 0.35820895522388052079 0.13432835820895522305 0.029850746268656715848 0.92537313432835777149 0.76119402985074602341 0.20895522388059700747 0.91044776119402948122 0.86567164179104438837 0.79104477611940271498 0.029850746268656715848 0.17910447761194028815 0.38805970149253721235 0.46268656716417899677 0.79104477611940260395 0.79104477611940260395 0.77611940298507431368 0.83582089552238780783 0.82089552238805940654 0.014925373134328357924 0.19402985074626866169 0.25373134328358204481 0.47761194029850739806 0.59701492537313405329 0.58208955223880576302 0.686567164179104239 0.89552238805970119095 0.91044776119402948122 0.97014925373134286435 0.59701492537313416431 0.089552238805970144075 0.89552238805970107993 0.58208955223880576302 0.11940298507462686339 0.52238805970149237989 0.43283582089552230521 0.14925373134328356883 0.86567164179104438837 0.9104477611940293702 0.59701492537313416431 0.46268656716417899677 0.8507462686567160981 0.59701492537313416431 0.074626865671641784417 0.10447761194029850373 0.25373134328358210032 0.40298507462686555813 0.82089552238805940654 0.97014925373134275333 0.19402985074626863393 0.71641791044776093056 0.94029850746268617279 0.044776119402985072038 0.11940298507462684952 0.22388059701492535325;0.050000000000000002776 0.16666666666666665741 0.033333333333333332871 0.10000000000000000555 0.79999999999999993339 0.24999999999999997224 0.91666666666666674068 1.000000000000000222 0.86666666666666669627 0.98333333333333339255 0.31666666666666665186 0 1.000000000000000222 0.6500000000000000222 0 0.98333333333333350357 0.76666666666666660745 0.14999999999999999445 0.46666666666666661856 0.81666666666666665186 0.93333333333333345916 0.5999999999999999778 0.70000000000000017764 0.48333333333333328152 0.43333333333333329263 0.3499999999999999778 0.21666666666666664631 0.050000000000000002776 0.38333333333333330373 0.81666666666666665186 0.16666666666666665741 0.58333333333333325932 0.98333333333333350357 0.2999999999999999889 0.76666666666666671848 0.93333333333333357018 0.38333333333333330373 0.050000000000000002776 0.050000000000000002776 0.96666666666666678509 0.25 0.050000000000000002776 1.000000000000000222 0.80000000000000004441 0.31666666666666665186 0.016666666666666666435 0.033333333333333332871 0.033333333333333332871 0.13333333333333333148 0.61666666666666669627 0.66666666666666674068 0.71666666666666656305 0.98333333333333350357 0.98333333333333339255 0.083333333333333342585 0.11666666666666666852 0.36666666666666664076 0.11666666666666665464 0.14999999999999999445 0.73333333333333339255 0.38333333333333330373 0.86666666666666680729 0.96666666666666678509 0.54999999999999993339 0.44999999999999995559 0.26666666666666666297 0.91666666666666662966 0.76666666666666671848 0.2999999999999999889 0.88333333333333341475 0.31666666666666665186 0.11666666666666666852 0.33333333333333331483 0.18333333333333334814 0.16666666666666665741 0.44999999999999995559 0.58333333333333325932 0.63333333333333330373 0.3499999999999999778 0.6500000000000000222 0.83333333333333325932 0.2999999999999999889 0.58333333333333325932 0.91666666666666662966 0.083333333333333342585 0.56666666666666665186 0.88333333333333330373 0.050000000000000002776 0.43333333333333329263 0.61666666666666669627;0 0.020202020202020203737 0.010101010101010101869 0.21212121212121215486 0.92929292929292905967 0.45454545454545464134 0.78787878787878784514 0.99999999999999955591 0.95959595959595922476 0.62626262626262640953 0.28282828282828287314 0.19191919191919193377 0.96969696969696939082 0.53535353535353547016 0.15151515151515151936 0.92929292929292905967 0.54545454545454563622 0.15151515151515154711 0.040404040404040407475 0.84848484848484817533 0.89898989898989889458 0.15151515151515151936 0.96969696969696927979 0.94949494949494928075 0.31313131313131320477 0.89898989898989867253 0.8484848484848485084 0.60606060606060618845 0.36363636363636370197 0.15151515151515151936 0.6666666666666668517 0.54545454545454563622 0.30303030303030309422 0.64646464646464663062 0.58585858585858596737 0.5656565656565658573 0.24242424242424243097 0.10101010101010100828 0.090909090909090911614 0.60606060606060618845 0.49494949494949508351 0.39393939393939403359 0.83838383838383823132 0.82828282828282817629 0.63636363636363657559 0 0.10101010101010102216 0.1111111111111111327 0.13131313131313132603 0.82828282828282817629 0.75757575757575779107 0.23232323232323232043 0.97979797979797944585 0.93939393939393900368 0.10101010101010100828 0.040404040404040407475 0.08080808080808081495 0.69696969696969723884 0.46464646464646480739 0.40404040404040408863 0.92929292929292905967 0.86868686868686872948 0.75757575757575779107 0.38383838383838392305 0.2121212121212121271 0.19191919191919193377 0.63636363636363657559 0.50505050505050519405 0.37373737373737381251 0.89898989898989878355 0.64646464646464674164 0.40404040404040414414 0.090909090909090925492 0.14141414141414140881 0.24242424242424245873 0.2121212121212121271 0.5454545454545455252 0.73737373737373768101 0.26262626262626265206 0.95959595959595922476 0.99999999999999955591 0.12121212121212120161 0.5151515151515153601 0.67676767676767701776 0.090909090909090911614 0.48484848484848502848 0.85858585858585878547 0.34343434343434353639 0.41414141414141425468 0.70707070707070729387;0.36065573770491798911 0.52459016393442636783 0.77049180327868893592 0 0.27868852459016391077 0.50819672131147564098 0.081967213114754106096 0.9016393442622956389 0.75409836065573809805 0.52459016393442636783 0.39344262295081972036 0.22950819672131145266 0.78688524590163977379 0.62295081967213139507 0.16393442622950818444 0.90163934426229552788 0.67213114754098390868 0.34426229508196720674 0.016393442622950820525 0.31147540983606558651 0.88524590163934469 0.081967213114754106096 0.60655737704918066822 0.91803278688524636575 0.1311475409836065642 0.78688524590163977379 0.96721311475409899039 0.36065573770491804462 0.27868852459016385525 0.36065573770491798911 0.44262295081967223398 0.37704918032786888249 0.5409836065573772057 0.44262295081967217847 0.50819672131147552996 0.63934426229508223294 0.91803278688524636575 0.80327868852459061166 0.52459016393442636783 0.32786885245901636887 0.18032786885245902231 0.16393442622950821219 0.34426229508196720674 0.36065573770491804462 0.26229508196721307289 0.1311475409836065642 0.47540983606557385421 0.88524590163934469 0.049180327868852458106 0.1311475409836065642 0.83606557377049217639 0.049180327868852458106 0.45901639344262312736 0.83606557377049228741 0.57377049180327888145 0.59016393442622971932 0.73770491803278726017 0.32786885245901636887 0.22950819672131145266 0.39344262295081966485 0.44262295081967223398 0.24590163934426223502 0.31147540983606558651 0.32786885245901636887 0.32786885245901636887 0.098360655737704930091 0.60655737704918055719 0.5409836065573772057 0.26229508196721307289 0.70491803278688547341 0.80327868852459061166 0.62295081967213150609 0.65573770491803307081 0.68852459016393474656 0.78688524590163977379 0.44262295081967217847 0.59016393442622971932 0.80327868852459050064 0.16393442622950818444 0.19672131147540983243 0.62295081967213139507 0.50819672131147552996 0.80327868852459061166 0.83606557377049217639 0.24590163934426226278 0.55737704918032804358 0.78688524590163966277 0.24590163934426226278 0.22950819672131148041 0.26229508196721307289;0.051546391752577316869 0.072164948453608240841 0 0.44329896907216492785 0.86597938144329922316 0.24742268041237114318 0.95876288659793851288 1.0000000000000004441 0.76288659793814450616 0.61855670103092785794 0.36082474226804117645 0.10309278350515464762 0.83505154639175260822 0.74226804123711342953 0.26804123711340205327 0.82474226804123718093 0.77319587628865993345 0.42268041237113396225 0.57731958762886581571 0.55670103092783507215 0.52577319587628867925 0.51546391752577314094 0.49484536082474217533 0.60824742268041243065 0.42268041237113396225 0.50515463917525771365 0.58762886597938135402 0.40206185567010310766 0.73195876288659800224 0.75257731958762885682 0.34020618556701032187 0.62886597938144328523 0.70103092783505149832 0.37113402061855671477 0.46391752577319578243 0.43298969072164944505 0.21649484536082475028 0.12371134020618555771 0.11340206185567010266 0.75257731958762896785 0.37113402061855671477 0.34020618556701032187 0.90721649484536115438 0.78350515463917536074 0.51546391752577314094 0.14432989690721648168 0.27835051546391753607 0.12371134020618557159 0.70103092783505149832 0.75257731958762885682 0.64948453608247436186 0.91752577319587658167 0.94845360824742286354 0.74226804123711342953 0.020618556701030927442 0.030927835051546392897 0.18556701030927835738 0.34020618556701032187 0.70103092783505149832 0.81443298969072175364 0.6494845360824740288 0.93814432989690743625 0.95876288659793840186 0.96907216494845394017 0.85567010309278368485 0.69072164948453629307 0.85567010309278357383 0.67010309278350510542 0.35051546391752574916 0.10309278350515463374 0.072164948453608240841 0.10309278350515463374 0.79381443298969078803 0.72164948453608246393 0.74226804123711342953 0.62886597938144317421 0.80412371134020632635 0.68041237113402075476 0.16494845360824741953 0.38144329896907219757 0.13402061855670102664 0.70103092783505172036 0.62886597938144317421 0.80412371134020632635 0.35051546391752580467 0.42268041237113401776 0.73195876288659789122 0.030927835051546392897 0.14432989690721648168 0.29896907216494850168;0.012500000000000000694 0.21249999999999999445 0.1375000000000000111 0.27499999999999996669 0.4749999999999999778 0.3624999999999999889 0.73750000000000004441 0.98750000000000015543 0.90000000000000013323 0.47500000000000003331 0.25 0.2625000000000000111 0.66250000000000008882 0.4500000000000000111 0.4124999999999999778 0.82500000000000017764 0.75000000000000011102 0.60000000000000008882 0.0625 0.57500000000000006661 0.7125000000000000222 0.125 0.76250000000000006661 0.85000000000000019984 0.42500000000000004441 0.88750000000000017764 0.86250000000000015543 0.5875000000000000222 0.38749999999999995559 0.037500000000000005551 0.75000000000000011102 0.55000000000000004441 0.22500000000000003331 0.75000000000000022204 0.76250000000000006661 0.5250000000000000222 0.21249999999999999445 0.10000000000000000555 0.2125000000000000222 0.5374999999999999778 0.375 0.47500000000000003331 0.76250000000000017764 0.72500000000000008882 0.65000000000000013323 0.050000000000000002776 0.087500000000000008327 0.2249999999999999778 0.1749999999999999889 0.67500000000000004441 0.75000000000000011102 0.37499999999999994449 0.88750000000000017764 0.92500000000000015543 0.2249999999999999778 0.11250000000000000278 0.1749999999999999889 0.65000000000000013323 0.4375 0.2999999999999999889 0.86250000000000015543 0.81250000000000011102 0.54999999999999993339 0.95000000000000017764 0.80000000000000004441 0.375 0.90000000000000013323 0.66250000000000008882 0.2750000000000000222 0.2625000000000000111 0.1124999999999999889 0.16250000000000003331 0.54999999999999993339 0.73750000000000015543 0.77500000000000013323 0.40000000000000007772 0.75000000000000011102 0.87500000000000022204 0.012500000000000000694 0.2249999999999999778 0.4749999999999999778 0.5250000000000000222 0.625 0.76250000000000006661 0.27499999999999996669 0.5 0.6875 0.18749999999999997224 0.3125 0.3499999999999999778;0.096774193548387107966 0.44086021505376349339 0.16129032258064521232 0.010752688172043011611 0.89247311827956965491 0.37634408602150537515 0.12903225806451612545 0.98924731182795666573 0.81720430107526864649 0.82795698924731164769 0.26881720430107530762 0.075268817204301077806 0.96774193548387066333 0.40860215053763443427 0.20430107526881724489 0.91397849462365565731 0.61290322580645162365 0.30107526881720436673 0.10752688172043012305 0.78494623655913964289 0.79569892473118264409 0.17204301075268818577 0.8709677419354836525 0.90322580645161265611 0.41935483870967749098 0.8494623655913976501 0.8602150537634406513 0.10752688172043012305 0.096774193548387094088 0.55913978494623661764 0.13978494623655915441 0.21505376344086024609 0.89247311827956965491 0.25806451612903230641 0.63440860215053751503 0.93548387096774165972 0.4838709677419354982 0.13978494623655915441 0.075268817204301091683 0.88172043010752665371 0.43010752688172043667 0.18279569892473121473 0.98924731182795666573 0.60215053763440851142 0.34408602150537642705 0.053763440860215054584 0.27956989247311836433 0.38709677419354837635 0.12903225806451615321 0.78494623655913964289 0.81720430107526864649 0.18279569892473121473 0.91397849462365565731 0.95698924731182766212 0.10752688172043012305 0.26881720430107530762 0.75268817204301063928 0.29032258064516131002 0.20430107526881724489 0.89247311827956965491 0.32258064516129036914 0.39784946236559148858 0.88172043010752665371 0.88172043010752665371 0.54838709677419350541 0.27956989247311825331 0.93548387096774165972 0.58064516129032262004 0.15053763440860218337 0.47311827956989249699 0.24731182795698930521 0.13978494623655912665 0.46236559139784938477 0.67741935483870963086 0.67741935483870963086 0.24731182795698927745 0.8709677419354836525 0.80645161290322564529 0.11827956989247312425 0.50537634408602161162 0.4838709677419354982 0.64516129032258051623 0.72043010752688163567 0.92473118279569865852 0.21505376344086024609 0.30107526881720436673 0.88172043010752665371 0.043010752688172046443 0.064516129032258062725 0.40860215053763448978;0.21052631578947367252 0.71052631578947333946 0.5 0 0.7105263157894735615 0.026315789473684209065 0.18421052631578946346 0.99999999999999966693 0.73684210526315774281 0.65789473684210508786 0.078947368421052627196 0 0.84210526315789446805 0.3421052631578946901 0.18421052631578946346 0.97368421052631548562 0.81578947368421017572 0.47368421052631570767 0.026315789473684209065 0.57894736842105243291 0.81578947368421017572 0.28947368421052632748 0.86842105263157853834 0.89473684210526283067 0.44736842105263152636 0.71052631578947367252 0.81578947368421028674 0.026315789473684209065 0.18421052631578946346 0.60526315789473672524 0.078947368421052627196 0.3421052631578946901 0.921052631578947123 0.13157894736842104533 0.57894736842105254393 0.94736842105263119329 0.078947368421052627196 0.71052631578947367252 0.78947368421052610543 0.18421052631578946346 0.42105263157894734505 0.49999999999999988898 0.7105263157894735615 0.18421052631578946346 0.18421052631578946346 0 0.15789473684210525439 0.078947368421052627196 0.18421052631578946346 0.7105263157894735615 0.60526315789473661422 0.39473684210526316374 0.89473684210526283067 0.97368421052631548562 0.18421052631578946346 0.52631578947368429233 0.89473684210526283067 0.10526315789473683626 0.36842105263157892692 0.78947368421052610543 0.18421052631578946346 0.3421052631578946901 0.7631578947368418131 0.81578947368421039776 0.42105263157894734505 0.9736842105263153746 0.3421052631578946901 0.63157894736842101757 0.81578947368421017572 0 0.13157894736842104533 0.39473684210526316374 0.52631578947368418131 0.84210526315789446805 0.81578947368421028674 0.18421052631578946346 0.86842105263157853834 0.73684210526315774281 0.10526315789473683626 0.52631578947368407029 0.28947368421052632748 0.99999999999999966693 0.10526315789473683626 0.36842105263157892692 0.97368421052631548562 0.052631578947368418131 0.15789473684210525439 0.026315789473684209065 0.026315789473684209065 0.052631578947368418131];

% ===== SIMULATION ========

% Input 1
x1 = x1';
% no processing

% Layer 1
z1 = negdist_apply(IW1_1,x1);
a1 = compet_apply(z1);

% Output 1
y1 = a1;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Negative Distance Weight Function
function z = negdist_apply(w,p,~)
[S,R] = size(w);
Q = size(p,2);
if isa(w,'gpuArray')
    z = iNegDistApplyGPU(w,p,R,S,Q);
else
    z = iNegDistApplyCPU(w,p,S,Q);
end
end
function z = iNegDistApplyCPU(w,p,S,Q)
z = zeros(S,Q);
if (Q<S)
    pt = p';
    for q=1:Q
        z(:,q) = sum(bsxfun(@minus,w,pt(q,:)).^2,2);
    end
else
    wt = w';
    for i=1:S
        z(i,:) = sum(bsxfun(@minus,wt(:,i),p).^2,1);
    end
end
z = -sqrt(z);
end
function z = iNegDistApplyGPU(w,p,R,S,Q)
p = reshape(p,1,R,Q);
sd = arrayfun(@iNegDistApplyGPUHelper,w,p);
z = -sqrt(reshape(sum(sd,2),S,Q));
end
function sd = iNegDistApplyGPUHelper(w,p)
sd = (w-p) .^ 2;
end

% Competitive Transfer Function
function a = compet_apply(n,~)
if isempty(n)
    a = n;
else
    [S,Q] = size(n);
    nanInd = any(isnan(n),1);
    a = zeros(S,Q,'like',n);
    [~,maxRows] = max(n,[],1);
    onesInd = maxRows + S*(0:(Q-1));
    a(onesInd) = 1;
    a(:,nanInd) = NaN;
end
end
