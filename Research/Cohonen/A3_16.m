function [y1] = A3_16(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 01-Feb-2022 17:22:26.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx85 matrix, input #1
% and returns:
%   y = Qx16 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Layer 1
IW1_1 = [91.208967088607579399 102.54567215189872798 93.989166582278471651 94.286646708860729404 107.26759303797467737 84.545889240506326701 89.326562405063285155 131.66110253164552546 125.77561202531644824 161.45306075949366686 98.533827848101253721 140.3856164556962085 83.851408860759491404 73.718196202531629524 75.244767088607588335 87.848108860759509753 97.947908860759469007 100.15019240506329368 79.598403797468336052 96.765705063291136412 109.38687594936708081 114.98630126582276034 65.045934177215173122 73.068379746835461219 107.72073924050631888 63.572832278481016033 73.602310253164546339 49.250324430379741614 52.657998607594926455 54.51456126582279893 53.681742405063303636 49.254320759493673165 52.815773924050631649 70.53960886075948622 58.624687341772151683 51.612182278481014919 95.418501265822797563 77.174436708860753242 64.207225316455705411 55.555936708860770068 58.114959493670880875 73.440879746835435071 69.896205063291148463 100.07304936708861476 110.63965063291139757 108.21269113924051908 115.76051265822783876 103.88616417721519269 113.84477974683544232 119.03537468354430473 121.1688987341772048 117.85839493670887634 118.80127088607594033 118.58378734177215108 83.214328734177229308 77.047519367088611375 83.69600759493670239 83.526672531645573372 88.14857392405065184 87.251726582278465116 94.751394936708834393 99.206524050632907574 77.99777126582279152 76.779605316455700859 97.877218987341748857 113.16971392405062602 112.94063544303797642 110.90436582278479705 115.5233987341772206 113.75305696202528338 102.22053797468356606 101.78552911392404212 93.953775949367098974 112.01848987341773523 102.3218405063291101 89.411618987341768161 97.316935443037976938 100.26552151898732745 80.598938860759517411 79.511040253164566138 86.949541772151917485 94.330173417721525198 84.542493670886059931 83.251079746835429773 86.010236708860759336;94.431491489361704339 82.705872340425528932 80.797740425531927144 83.935970212765951715 89.875995744680849953 75.608780851063812634 73.66383617021276109 95.974934042553201152 94.489672340425542529 115.7795063829787523 75.785955319148925469 96.111261702127663398 70.171542553191486036 65.063210638297874766 63.964902127659570397 71.159502127659578719 79.651034042553192194 82.915170212765943347 64.318657446808501277 75.113874468085100489 89.437405957446799221 101.88265106382978331 109.71531702127660424 107.99116595744681035 117.45022553191489578 112.44619574468084977 93.039808510638280836 107.69927659574467782 130.43678723404252651 130.55084468085104277 134.732236170212758 129.59737234042552245 127.4017106382978568 96.296197872340442814 80.120451063829776217 92.808234042553195309 104.99004468085105657 106.18798297872341152 103.92637234042551597 106.71134042553191534 107.99186382978723486 101.84948510638297137 99.592382978723392739 91.423753191489339542 103.15561914893616802 100.45666382978724585 107.94479361702127562 96.870070212765952533 106.62475957446810071 112.68586595744680778 113.42374680851061441 116.73971914893616031 109.83123617021276175 110.53773617021276721 73.975529787234052037 73.066265957446816515 77.468687234042548084 71.96112127659573332 73.239121276595739118 75.633019148936156739 85.275082978723403926 88.885180851063822161 63.986563829787229452 64.118699148936158849 94.929893617021278374 116.81229361702126823 120.38225957446807968 120.58268510638299631 112.46319574468085989 113.99282340425530435 108.5197787234042579 113.76727872340423176 104.50510425531913938 112.47694893617021705 104.62828085106383469 77.970593617021265231 87.385002127659575422 92.319876595744673864 66.108623404255297373 66.016685106382965387 76.485912765957436932 87.533051063829788063 81.144355319148928629 67.423074468085104627 69.823238297872336489;102.93553148148147613 113.62750740740740696 85.481772222222218716 84.379992962962958813 112.51319999999996924 65.539424999999980059 75.48175740740738604 178.54335185185183832 174.84366666666664969 201.05438888888886595 132.61023333333329788 203.426111111111112 68.024774074074088048 55.87701796296295953 60.049064814814819613 70.522429814814813653 84.090733333333332666 119.36174444444442599 85.354418518518528458 152.35175740740743322 103.59247592592592468 132.69284629629629535 103.05408148148146097 158.61125925925927049 190.95757407407410255 153.43528148148149626 176.99877407407404917 118.67648518518514322 82.095422222222225628 110.43182592592590652 81.385949999999979809 76.879796296296291302 61.120150000000002422 106.38454259259259516 127.37007962962961471 89.941362962962955407 116.73787777777778274 94.449383333333315704 67.184009259259269697 67.404231481481474475 60.453218518518518465 77.890853703703697875 63.852472222222218079 92.125409259259257055 98.114549999999994156 91.557235185185191995 102.50505555555554338 89.93329259259257924 106.85348888888887586 118.83880370370371793 119.65481296296297842 120.52117222222221926 115.79583518518516883 119.03550925925925696 68.905707407407390974 62.244005555555553144 71.520625925925912725 66.970852592592578389 74.201838888888886459 81.893155555555551928 83.997268518518495739 95.556240740740733486 70.824316666666661035 76.16966481481479434 104.57696481481478656 121.05590925925925205 121.06442777777778019 112.2264851851851688 122.78357592592590208 128.64683148148148462 103.74904814814813392 101.44230185185183757 88.601683333333312476 116.68260370370367696 108.87471666666667147 95.59828518518517626 102.0833111111111009 108.58304629629630256 84.890764814814801298 86.470690740740735691 98.576438888888887391 107.07693518518517806 100.0537833333333424 96.290714814814833744 92.222190740740728643;105.21707678571428346 97.10341250000000457 67.094924999999989268 63.344331249999996203 92.692608928571416982 40.872373035714282707 67.097323214285708559 166.12866071428570081 154.44938035714287139 191.44818035714285998 130.87173214285712675 182.92261785714285338 42.084186249999987695 37.832167499999997062 50.151316071428567511 35.327249107142861817 43.455476785714282073 108.45329464285714494 88.801603571428557871 163.03725357142855046 60.640292857142853222 115.63550714285712218 180.14253571428571377 216.68364285714287121 220.51291071428568102 218.67076428571425595 214.15552857142853327 213.18861071428571563 203.77551964285714803 216.26842857142858634 193.58081607142858616 220.0069107142856808 188.50443928571428387 158.08024999999997817 189.22709821428568944 188.69753571428569217 130.56128928571428105 123.97127321428570212 143.7818571428571488 189.96542499999998199 151.15499642857142248 127.79119285714284615 109.17500892857142958 61.638808928571421575 57.348714285714279981 47.479832142857141264 58.692237499999990291 53.784779464285712436 67.826644642857147005 91.485498214285712493 77.13795000000000357 100.04787500000000477 87.57698214285713334 99.484944642857129793 40.269855535714285111 39.449333035714282403 45.270512499999995271 35.435323571428568812 40.302031249999998863 56.178776785714283903 57.294501785714274433 72.150126785714277844 43.759823571428569267 50.535120357142858438 84.625469642857140684 105.99691249999997922 107.20431250000000034 100.68268035714287123 108.34807142857141571 108.08410714285713539 91.438969642857145459 95.457982142857133567 81.513417857142854928 101.01460714285713038 88.957757142857133204 69.224507142857149233 79.533666071428569921 81.987005357142834328 55.648919642857137546 59.449233928571423746 72.946537500000005139 78.901224999999982401 83.579810714285713402 73.006071428571416959 58.782123214285704194;115.25114722222222952 137.98400000000000887 128.59498055555556562 133.91894166666665456 183.23432222222220389 84.442233333333319933 107.57872777777777173 220.83258333333327528 227.96219444444446367 234.76166666666665606 190.18831666666662272 229.74408333333335008 86.526141666666660512 79.746425000000002115 73.966247222222207824 103.56575555555555468 90.047561111111107834 113.71410555555553401 101.16253055555556273 187.63155555555553633 69.318325000000001523 93.757397222222209621 93.903605555555557771 162.25365277777780193 212.02516388888886922 151.29321944444444625 181.96572222222221171 109.52913055555553967 78.581688888888876932 105.34241111111110456 73.897277777777773622 78.059916666666680385 59.104847222222218761 88.1626583333333258 132.74418888888888546 76.293047222222241999 83.555277777777774872 62.912819444444430417 48.521861111111121545 55.350602777777780261 44.579618333333336011 54.202944444444440819 39.719024999999994918 131.47977777777779806 130.57463888888887027 126.36493888888885806 114.08828888888886866 150.04080555555555065 133.38058333333333394 130.4053000000000111 103.59049444444443111 140.2982638888888971 135.77530555555551928 140.57738333333333003 155.05177777777777237 158.0012222222222249 146.37541666666666629 158.88224999999997067 158.64263888888891074 110.6996027777777698 121.30103611111111661 99.327761111111115611 123.24070833333333042 101.1493944444444395 98.75928333333334308 111.5818305555555412 121.88890555555552453 88.182738888888891893 133.58198333333334062 105.41493888888891206 109.93290833333333012 73.892886111111110381 103.6663861111111089 81.52713611111110481 174.02894444444442001 75.362197222222221171 80.304205555555554952 70.97913888888888323 80.624944444444452074 70.527647222222228152 96.109888888888889369 62.328141666666660115 174.72300000000001319 73.010894444444431883 73.081324999999992542;112.70102933333333795 127.10870266666668726 141.96896666666668807 139.70427866666665295 152.85322266666668156 131.77923599999999738 142.62048799999996618 159.50880399999996939 160.32886799999999994 169.59542133333334846 143.87874000000002184 162.85520400000001473 100.58108666666666409 103.63878133333332698 101.93396666666667727 95.522982666666678142 101.16805466666669133 105.59402933333335284 97.458985333333345125 114.05383600000000399 101.38340933333334704 108.69806800000000635 136.42068000000000438 165.81048533333333239 173.39105066666670041 166.22502266666668902 167.83173333333334654 155.68747999999999365 169.80587866666667196 177.14536400000005756 175.32223333333334381 166.36715466666669272 161.91754800000003911 107.57071866666666438 113.68023600000000783 106.02178266666669515 107.21960000000001401 103.50049200000000837 103.15644666666666751 114.90055066666667472 113.76611066666669103 97.463033333333342512 87.47349199999997893 91.563583999999991647 105.9096800000000087 105.25219466666665369 114.3799359999999723 94.511150666666679854 108.41204799999997022 118.96977466666668022 123.87724000000000046 124.07338000000000022 112.99813733333336074 114.895465333333334 68.606398666666692066 67.087529333333336012 71.25334400000001267 66.478658666666675003 69.373892000000012104 72.408661333333327548 78.23688133333332928 84.145397333333349366 62.458316000000003498 64.255818666666655758 97.829570666666654688 122.3559053333333253 126.55127066666665314 127.62820933333334494 115.70337733333333574 119.72472666666668317 108.97291066666667803 117.98633066666666025 101.85761466666666308 113.73086666666667099 104.01414266666667174 79.961320000000014829 87.711592000000010216 92.296493333333359033 70.203572000000008302 69.441401333333345747 80.775947999999999638 89.022012000000003695 79.43680266666669354 78.273372000000009052 77.526076000000003319;104.44404565217392644 149.53009782608694422 145.50952608695649815 138.35222500000003265 154.10283804347824343 141.22573260869563683 147.19326739130434589 191.60095652173916392 182.15793478260872007 201.60091304347832875 169.14843478260871734 211.48779347826089747 120.44853369565215928 135.34301847826085918 133.08418152173913995 110.07905869565216506 103.59574673913040499 138.63477391304346042 136.08325543478264308 192.53738152173912113 100.86097608695651218 121.93316956521735506 140.60464130434780827 173.9314891304348123 196.56566304347828122 160.29472173913035249 191.29738043478263876 150.4986815217391154 154.77035652173910307 154.23122391304346479 156.35214999999999463 150.82033695652171446 157.84585108695654299 117.88916086956521667 158.7661250000000166 127.07853695652171666 101.04094565217390311 85.876222826086944906 116.05340217391305657 136.75971956521740935 143.69499456521737102 90.123336956521711727 93.543276086956495874 70.652536956521728939 87.810565217391285842 87.962188043478263921 94.130130434782643079 81.708221739130436845 86.947352173913046158 94.278780434782589737 98.499924999999990405 99.427052173913011757 91.03217499999999518 88.445339130434774688 47.14007717391304908 62.885845652173919973 66.333840217391298211 29.106045652173911265 29.969160869565218519 53.181355434782624059 68.226965217391310148 70.932756521739122491 31.565211956521739722 41.436398913043468895 61.027720652173925941 80.494495652173924327 88.903044565217399509 78.641092391304368903 81.434406521739134632 73.859001086956524773 63.376229347826068761 68.152228260869577525 60.635319565217415061 67.518510869565204757 58.197104347826105197 52.28284891304347326 66.597613043478247619 62.003382608695638112 41.24594239130433948 39.44227065217391015 48.623107608695647741 59.841903260869578673 53.780373913043483469 41.282240217391297676 40.665434782608691933;108.99409193548386554 157.42780645161289499 151.38276935483867192 141.74188338709677737 190.91565483870965636 104.68702258064514865 162.42025967741932391 228.3845645161290463 222.47912903225807213 231.59912903225804826 221.45753225806453202 237.12882258064513508 78.247477419354837025 70.020171774193542547 112.24038548387096625 53.436258064516131583 72.504020967741922732 168.99123870967744665 184.39539516129033814 225.0903370967741921 119.70111451612902442 145.00614677419355303 137.4168241935483934 217.15354838709680507 232.20262903225804507 212.35396774193549163 229.864661290322573 198.46840322580646898 132.74237419354838607 166.63404516129031663 131.72660161290320957 135.11121612903224332 100.26475483870966343 137.16520806451615044 195.02258548387098358 151.63891290322578698 114.99978387096773247 90.410856451612900742 65.706193548387091141 95.397304838709672481 62.398370967741932702 64.048553225806443834 42.688536612903227763 73.552067741935488243 73.554258064516119475 63.600237903225796288 78.994722419354843623 69.154719354838718459 80.795570967741923596 102.33130322580646521 98.888320967741933032 110.46805967741936172 97.408470967741934032 102.12549032258064585 49.309398387096770477 50.124558064516136824 58.683982258064510518 40.858237096774196573 46.630803225806452872 68.175853225806449132 74.311920967741926347 84.091793548387101964 52.055954838709681098 61.574704838709678256 71.623008064516113791 94.180116129032256822 101.439724193548372 82.4442370967742022 100.98976612903224748 93.450077419354840913 61.71620806451613106 60.747816129032258914 43.257364516129030108 75.456245161290311785 67.972746774193538499 69.095275806451610379 81.558038709677418865 77.378525806451605717 60.996446774193557872 56.99559838709677706 62.544267741935485105 68.834646774193544161 71.538977419354836229 60.196729032258069481 51.251196774193559236;83.977477142857139825 121.15739285714283824 88.589812857142831604 85.627740000000002851 112.32034714285715893 69.298889714285706987 83.689861428571433066 197.53285714285712515 183.39646000000001891 232.03437142857140429 142.76973999999998455 228.66487142857144477 68.958683428571433183 60.354074714285708581 67.478400142857140054 69.573836714285718585 77.295430285714303409 125.98307285714285797 99.219728571428561281 183.68056428571429706 91.061827142857140416 126.13811999999998648 85.074541428571421875 130.45882857142856892 190.92450285714284064 106.73611999999999966 151.6450328571428372 78.196237142857142999 69.512505714285708791 76.831352857142860557 68.494089714285706805 67.532489999999995689 65.259184857142855662 84.188747142857138783 109.35625285714286292 67.51318571428571147 95.737595714285703252 66.655454285714284879 57.381711285714288806 61.894118857142856882 55.609781714285702492 60.872247428571427008 51.502377285714281641 68.286992857142848834 75.647423999999986677 73.063221999999996115 81.640379428571421272 69.740799714285714117 77.225824285714281814 92.972204285714298067 89.433362857142867597 101.57121857142855959 88.17175428571428597 92.124641428571408142 46.033217142857139947 47.6680788571428522 52.53438099999999622 40.51038914285713588 42.993578000000006512 57.852281428571423305 62.407041428571439212 74.594137142857135814 43.317089714285707203 50.388726142857130696 64.251504285714275966 84.613632857142846433 93.524917142857162844 78.048191428571428219 88.041085714285713948 79.998098571428570835 64.088562857142861162 65.444971428571420802 53.117624857142857309 71.270472857142848966 66.969652857142861535 55.943841428571424501 68.030082857142843977 62.524949999999996919 48.477371000000005097 45.166231714285714816 52.861597142857135623 57.317491428571429424 61.748731428571417723 48.78263871428571008 44.527205714285713611;113.05363333333333742 164.40737254901961251 175.12660784313726481 160.78941764705885475 176.77135294117647391 168.32462156862746383 192.93229411764704651 191.10723529411762911 183.26509803921567254 186.52664705882352791 200.0938627450980789 195.07010588235291948 138.3874176470588111 149.24336666666667384 166.09703137254902572 110.95464313725490513 125.80323529411764127 152.97596666666666465 175.53304117647059002 169.81154705882354961 130.24850196078432418 137.20677647058823823 105.14894117647060057 158.95449411764701608 178.51432352941176873 159.60608039215685494 168.09112352941176027 132.44655294117649191 99.970550980392147267 131.0327862745098173 100.10870196078431604 96.647560784313739646 74.144594117647073972 103.04590784313725749 131.01799019607844343 93.131803921568632632 104.91061764705882808 85.414396078431380488 60.576490196078424333 66.229190196078434383 52.538049019607839796 71.829898039215692052 52.621175294117641386 93.399243137254885028 103.02592549019607304 100.39566274509803634 110.40419215686274867 94.950264705882347016 105.21284509803922447 120.11095686274509831 118.43033725490195707 125.3776039215686211 118.04347647058824577 118.68702156862744346 72.735754901960788743 70.884233333333327209 74.68494117647058772 71.201280392156860444 73.921174509803918795 77.391754901960780444 84.575472549019607982 90.683268627450985377 66.741615686274514019 67.125898039215684321 92.078754901960792267 111.23082156862744796 110.55265098039217264 101.1328843137254978 117.23008823529410449 116.66674901960783473 90.759192156862738443 89.906723529411763707 72.509903921568621854 106.4332450980392224 94.878350980392141878 83.420331372549014759 91.467698039215690642 95.869205882352943604 71.883484313725489301 74.191949019607847049 83.678964705882350472 90.834960784313722115 85.422062745098031655 85.88940392156862913 74.277294117647059579;135.10276000000001773 185.28280000000000882 213.73703999999997905 212.11475999999998976 217.19571999999999434 206.78578800000002502 218.6558199999999772 208.77290000000002124 211.79695999999998435 205.90831999999997493 214.64128000000005159 203.75888000000000488 151.25299799999999095 181.03692000000003759 192.11680400000003033 114.62675200000001041 116.62471200000000238 167.47380000000001132 201.38600000000005252 199.22700000000000387 125.92385599999998647 143.13276400000000876 162.19821999999999207 193.21002000000004273 193.25670000000002346 187.01236000000000104 199.79528000000004795 193.51618000000004827 177.66406600000001959 184.95963800000001243 177.74378000000001521 183.4940339999999992 166.43234400000000051 152.96191199999998389 188.4959999999999809 182.58105999999997948 125.0126160000000084 116.78639599999999632 126.37423599999999624 168.81935200000003761 145.6765219999999772 105.08785200000002646 87.445835999999985688 100.34264799999999696 109.64364199999998561 104.72010999999997694 106.93810599999999056 114.9012299999999982 112.13888800000000856 109.98388800000000742 110.22188200000002212 114.49894800000001283 109.99764400000000819 105.36633599999998978 104.24623200000002043 111.75398000000001275 101.96028600000002484 101.92224399999999207 102.56413399999999569 78.111824000000012802 86.056174000000012825 77.060281999999986624 81.154735999999999763 69.206023999999999319 95.853580000000007999 112.20232000000000028 120.11966199999999105 117.35447200000001544 101.6505159999999961 109.77359200000000783 121.65901600000002247 105.35741799999999557 116.52243800000000817 103.35486200000001134 157.88270199999999477 62.090815999999989572 67.801824000000010528 65.360383999999996263 59.522202000000000055 56.050914000000005899 86.119355999999967821 62.503348000000009677 149.5192260000000033 66.508323999999987564 64.992053999999995995;120.6316470588235461 155.65892941176471709 178.50144705882348717 182.73184588235289993 205.08652941176470108 144.83852352941178765 178.17762705882353202 222.25396470588236753 223.42450588235288933 225.63352941176469812 213.9218494117646685 225.81469411764703636 84.326436470588234329 92.509720588235296646 110.96182470588234992 62.181580352941175249 69.504699999999985494 135.91202352941175491 152.12557176470588161 189.19432470588236583 84.718047058823529483 115.78046352941176167 172.50331764705882165 217.4432823529411678 222.03362352941175573 217.91916470588233778 217.22518352941173703 212.39180000000001769 213.34242352941174659 221.39235294117645481 207.27374117647059393 220.6397411764706078 206.42649411764705292 135.09765411764703913 167.42995176470589058 164.94054117647058888 103.70465882352939957 103.77314117647058822 125.37540588235292205 166.2509600000000205 147.08260941176467895 101.47656705882351957 88.401725882352934605 72.857747058823534303 78.998102352941174331 72.789418823529402403 86.334925882352933968 72.768381176470583682 82.78000823529411889 97.952335294117645503 100.70727882352940696 103.15128470588234677 92.129767058823532011 95.506430588235289747 52.594605882352944093 54.676445882352943784 57.961610588235288333 46.438549411764704189 50.954576470588236248 61.311982352941171825 64.876500000000007162 72.831641176470583332 51.254881176470590276 55.737122352941177894 84.835210588235298701 100.52777176470588927 103.26217411764704934 97.792839999999998213 100.88984235294118719 100.47478941176470357 90.395802352941174718 94.244648235294121719 78.986028235294128308 95.744914117647041962 93.156256470588232332 71.540288235294113406 76.423748235294112874 83.107788235294108858 59.864951764705878645 66.088995294117651724 77.693410588235309433 81.729575294117651652 86.251942352941171066 82.086709411764715583 62.915739999999992449;100.21171020408161212 182.31448979591834814 203.1007346938775413 201.86439591836730756 220.69942857142854109 184.91598367346935561 203.41903469387753489 223.55710204081631787 229.98479591836735381 229.66544897959181526 208.26513469387754185 226.59104081632648331 138.90474897959182954 152.33139795918367554 165.06157346938772434 110.20272653061222456 126.7910183673469362 163.29407755102042188 173.69309999999995853 198.80416938775510971 133.22331224489795432 147.07133061224487847 81.015265306122444144 141.22193265306120225 193.30236734693875178 121.26985714285711992 170.77432244897957503 86.29916530612244685 58.790406938775511492 71.737025102040817615 61.485294693877541761 53.030169999999991148 48.84747816326529346 84.193748979591831016 128.16510408163264856 61.408948979591833961 93.374508163265289795 57.328561224489789083 41.271871020408163133 45.249671632653061693 42.622874285714289044 41.22293653061224461 35.386673877551018563 81.175055102040801103 93.589061224489782376 91.813006122448982183 104.69855306122448724 82.092367346938772243 94.426318367346937066 107.01199387755100645 111.92128163265304863 111.93145102040816141 103.83182857142855937 100.80752244897959713 56.041532653061217673 56.871106122448971121 66.634128571428576038 47.944728571428555597 51.905087755102030656 67.874516326530610399 78.148877551020405008 84.307230612244879353 52.592808163265303278 56.36782857142855363 60.344665306122436732 81.723202040816318004 89.232618367346930199 64.883869387755098046 93.958781632653057159 80.746767346938767673 50.901769387755102514 45.117366734693874264 36.177722653061223923 62.904297959183672617 59.323716326530615106 57.913224489795915417 72.802773469387744854 65.806869387755099865 49.385306122448973554 44.297136734693879134 51.347799999999992338 57.821999999999988518 61.839769387755097796 46.223218367346930791 40.426918367346935668;116.38709523809524171 189.83672619047621311 206.37669047619047547 196.47627380952383191 210.67344047619047842 200.83391666666668129 216.12889285714283005 225.17396428571427691 219.67449999999996635 222.69740476190474965 226.4662619047618648 231.71477380952381964 156.20939285714283074 180.80624523809524362 196.41997619047614876 121.61269166666667729 125.33636309523807029 171.13043452380952658 202.70886904761900382 219.70191666666667629 124.75763214285713332 137.06013928571431393 153.26204761904759266 213.96699999999995612 220.80276190476189413 211.16947023809524353 222.78789166666663846 202.76870595238094097 176.42544761904758843 197.05770238095234959 174.63511904761901405 180.72251428571428278 156.1944309523809693 134.14826190476188117 197.33153809523804512 154.8642428571428411 104.28159404761905193 82.802520238095226546 90.597286904761901383 124.16505595238092496 108.20066904761904425 69.597455952380940403 61.537410714285712743 67.46769166666665285 79.333898809523802242 84.229838095238093842 87.595690476190469553 69.356182142857136341 75.708869047619046455 86.526623809523798059 90.273415476190479012 92.189965476190465665 82.112219047619049661 81.729880952380952408 48.313877380952376939 53.61037619047618108 59.889438095238105575 37.913245238095235834 41.357422619047611079 55.534911904761905532 65.654370238095225432 68.301549999999991769 41.991225000000000023 46.033601190476183262 59.664340476190467655 77.16714999999999236 84.257296428571436309 72.925563095238075562 77.558840476190468394 74.864595238095219543 58.420999999999999375 58.393084523809513087 49.649121428571433512 64.959897619047623607 61.055882142857143435 52.198273809523811906 62.41302857142856908 60.037588095238092478 45.612211904761906567 41.067157142857141139 51.366398809523794 56.223798809523806597 61.285364285714287291 46.075872619047615331 42.733708333333325413;126.29605555555556862 194.85885185185185264 208.55622222222223172 204.50355555555552201 208.84691666666660126 206.64107407407408346 213.98745370370369301 211.87988888888884276 205.74486111111107789 207.83228703703699125 215.81477777777774918 217.98802777777780193 163.75625277777777455 186.68549814814815591 203.67553703703697465 120.25656666666668571 142.6283638888888845 194.69552777777775532 215.37271296296293599 221.0263796296296448 163.30088518518516594 178.70377222222222713 193.38896296296297805 212.82040740740737306 208.62852777777777646 208.05410185185181149 216.42707407407408482 218.26876851851849892 205.30406481481480796 206.26073148148145719 200.2405425925925897 215.11149074074074861 201.37210833333330129 193.19918888888892639 220.20452777777771303 218.40139814814813235 171.31306666666665706 164.05397685185181444 164.09166111111110808 212.6113425925926208 188.47912685185175974 142.5100259259259019 116.29734999999999445 58.926780555555538399 64.681346296296297282 62.66795648148147535 72.490690740740745923 56.543413888888878205 66.040585185185179284 78.804553703703717815 81.912984259259260966 87.562739814814818828 73.411481481481473566 72.354993518518497808 43.060499074074073178 42.65182037037036622 46.24415648148146829 40.624225925925927072 42.397354629629624867 48.902411111111106834 57.331427777777761889 61.076599999999992008 39.01448981481480871 38.137291481481469191 62.574166666666656056 76.439317592592601613 83.28168425925925078 77.756024999999993952 73.123206481481474839 71.977317592592598317 68.065064814814789429 71.295593518518501241 60.938068518518520023 66.032478703703702649 73.796051851851871106 49.235972222222208927 59.832354629629641352 59.077615740740732519 37.822255370370363892 40.304009259259260034 56.913937962962947381 51.023478703703695203 74.543099999999995475 56.564151574074074347 46.818757407407417759;128.69269047619047797 174.09982142857145959 165.24783928571429215 150.42647619047619401 161.88206428571427864 169.98346904761905307 177.9231428571428637 182.84784523809526036 173.48688690476188867 182.51282261904759707 182.37382142857143208 192.15885714285712993 158.21611666666663609 168.06021904761900032 190.77576190476190732 125.18354047619047265 147.08926666666667415 189.08720238095233412 198.32090476190472828 205.27241666666662923 167.57504047619045195 184.41707142857137569 179.93469047619043977 192.71685714285712265 187.25212023809524453 189.35427976190470645 197.99215476190471463 196.30551190476188594 182.03667619047621429 191.02267023809525881 173.07534166666664532 190.20259880952380627 176.0194452380952157 185.51091666666667379 204.65995238095240438 200.23470238095234208 174.1807142857142594 163.83394166666667502 161.12165595238093374 192.97680000000002565 174.53521071428571076 151.73428690476191605 127.64587499999998954 76.223311904761914093 83.581461904761894743 78.154767857142843468 95.931101190476198326 69.760302380952367685 88.59235357142857481 110.3472892857142682 111.283299999999997 119.86574880952380795 105.11445238095237187 104.6601761904761787 45.143248809523804255 42.933983333333330279 54.44298214285714721 37.631574999999997999 44.560320238095229683 64.911690476190472054 71.681135714285716176 81.669108333333326755 48.865853571428573332 56.497267857142873027 88.550428571428568603 113.69166547619047947 117.58042142857142665 110.5010249999999985 112.72003333333331909 114.54872976190476663 90.061707142857144959 103.46123095238095857 74.857211904761896903 101.8744309523809477 81.808691666666661035 79.197047619047609146 88.730972619047633998 93.631867857142850653 63.48325595238095076 70.606217857142851813 72.971244047619052253 84.192027380952367821 70.250677380952367912 83.044954761904747897 57.85964404761904234];

% ===== SIMULATION ========

% Input 1
x1 = x1';
% no processing

% Layer 1
z1 = negdist_apply(IW1_1,x1);
a1 = compet_apply(z1);

% Output 1
y1 = a1;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Negative Distance Weight Function
function z = negdist_apply(w,p,~)
[S,R] = size(w);
Q = size(p,2);
if isa(w,'gpuArray')
    z = iNegDistApplyGPU(w,p,R,S,Q);
else
    z = iNegDistApplyCPU(w,p,S,Q);
end
end
function z = iNegDistApplyCPU(w,p,S,Q)
z = zeros(S,Q);
if (Q<S)
    pt = p';
    for q=1:Q
        z(:,q) = sum(bsxfun(@minus,w,pt(q,:)).^2,2);
    end
else
    wt = w';
    for i=1:S
        z(i,:) = sum(bsxfun(@minus,wt(:,i),p).^2,1);
    end
end
z = -sqrt(z);
end
function z = iNegDistApplyGPU(w,p,R,S,Q)
p = reshape(p,1,R,Q);
sd = arrayfun(@iNegDistApplyGPUHelper,w,p);
z = -sqrt(reshape(sum(sd,2),S,Q));
end
function sd = iNegDistApplyGPUHelper(w,p)
sd = (w-p) .^ 2;
end

% Competitive Transfer Function
function a = compet_apply(n,~)
if isempty(n)
    a = n;
else
    [S,Q] = size(n);
    nanInd = any(isnan(n),1);
    a = zeros(S,Q,'like',n);
    [~,maxRows] = max(n,[],1);
    onesInd = maxRows + S*(0:(Q-1));
    a(onesInd) = 1;
    a(:,nanInd) = NaN;
end
end
